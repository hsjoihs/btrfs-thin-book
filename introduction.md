本書はBtrfsというlinuxのファイルシステムを様々な側面から紹介することによって、Btrfsに興味を持ってくれる人、ユーザ、およびコントリビュータを増やすことを目的としています。一般にファイルシステムの長所を説明する際は、性能や最大ファイルシステムサイズ、最大ファイルサイズ、最大ファイル数などを挙げることが多いですが、Btrfsの主な長所はそれらの要素だけでは説明がつきません。Btrfsの売りは、ext4やXFSなどの従来型のファイルシステムには無い、および、構造上提供できない豊富な機能(後述)です。ZFSを使ったことがあるかたがたにとっては、ZFSに似た機能を提供すると考えてもらえればわかりやすいかもしれません。ただしBtrfsはZFSクローンではありません。コンセプトは似ているものの、ユーザインターフェイスも実装も異なる、あくまで別ファイルシステムです。

Btrfsはスマートフォンからエンタープライズサーバまでの幅広いシステムに使えるファイルシステムを目指しています。そのために、とくに次に挙げることを意識して開発しています。

- スケーラビリティ: ストレージ容量、CPU使用量、およびメモリ使用量など
- データの一貫性: ファイルシステムレベルでのチェックサム、RAID、およびこれらを利用したデータ破壊検知/修復
- 多様なストレージの取り扱い: HDDだけでなくSSDも意識した処理、それぞれ異なるサイズを許容するマルチデバイス構成

Btrfsとは本書執筆時点(2017年10月)において、Linuxのローカルファイルシステムとして、ext4, XFSと共によく使われており、多くのディストリビューションにおいて利用可能です。本書を読んでBtrfsに興味を持ったかたは、ぜひ試していただきたいと思います。後述の通り、Btrfsはext4のファイルシステムから変換することによって作成すること、および、不要になったら再びext4に復元することもできます。

本書はBtrfsの機能、運用方法、トラブルシューティング手法、歴史、媒体構造、カーネル内の処理論理について、Btrfsを知らない人が使用するにあたって必要最小限の情報のみを記載しています。機能の詳細な説明はしていませんので、そのような情報を知りたいかたは本書を読んだ上でmanや公式の情報源である[Btrfs wiki](https://btrfs.wiki.kernel.org/index.php/Main_Page)をごらんください。これらの公式情報があるにも関わらず本書を書いた理由は、これらは網羅的であるものの情報量が多すぎてどこを読めばいいかわからないこと、および、古いバージョンの情報が混在して若干見づらいことです。

本書を読むにあたってBtrfsについての事前知識は必要ありません。これまでにlinuxシステムを使ったことのある人でしたら、だれでも読めるように書いています。本書の前半は、Btrfsを知らない人向けに、Btrfsの長所について書きます。中盤は、Btrfsについて既に知っている人に対して活用例やトラブルシューティング手法を紹介しています。後半は、技術的に興味がある開発者に対してデータ構造や処理論理などを説明しています。

本書の説明におけるソフトウェアのバージョンは、次に挙げる本書執筆時点で最新のものです。

- linuxカーネル: v4.13
- btrfs-progs(Btrfsの管理ツール。詳細は後述: v4.13.1)

一部の実行例においては古いバージョンのbtrfs-progsを使用していますが、最新版でも挙動は変わらないので気にしないでください。
