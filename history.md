本章はBtrfsの歴史と現在の状況、および筆者による将来の予測について述べます。

Btrfsの開発は2007年に当時Oracleに所属していたChris Masonさんによって始まりました。彼はその後Fusion-IO、そして現在所属しているFacebookという2つの会社を渡り歩きましたが、現在まで一貫してメンテナとして開発リーダーを務めています。FacebookというSNSプロバイダのエンジニアがカーネルの主要ファイルシステムのメンテナをしているというのは面白いです。その理由については後述します。

Btrfsの開発は、linux-btrfsというメーリングリスト上で開発者たちやユーザたちがコミュニケーションをとりつつ進められています。開発者の多くは企業に所属しているエンジニアですが、趣味で開発に参加している人々も、筆者を含めて少なからずいます。開発に参加している主な企業は前述のFacebook, Oracleに加えてSUSE、富士通などです。linux v4.0以降のcommit数の多い順番に並べると次のようになります。

|企業名|パッチ数|
|:------|:------|
|SUSE|641|
|富士通|224|
|Oracle|207|
|Facebook|178|

Btrfsにはメンテナが3人いて、うち一人は前述のChrisさんです。残る二人のうちの一人は同じくFacebookのJosef Bacikさんで、もう一人はSUSEのDavid Sterbaさんです。最近ではBtrfsの開発ツリーからLinus Toravalds氏が管理するmainlineカーネルへのpull requestをChrisさんのかわりにDavidさんがするようになっていたりと、将来的にはDavidさんが開発リーダーになるのかもしれません。もちろん最近たまたまChrisさんが忙しかっただけかもしれません。あくまで推測です。

それぞれの企業がBtrfsの開発に投資している動機は何でしょうか。Facebookは実は自社サービスのバックエンドとしてBtrfsを使い倒しています。単一の組織としてはBtrfsを世界一の規模で使っているのではないかと筆者は推測しています。その安定稼働のためと考えれば同社がBtrfsのメンテナを2人雇用しているのは自然なことに見えてきます。余談ですが、同社はBtrfs以外にもカーネル開発者を複数人雇用しています。

SUSEがBtrfsに投資する理由は、同社が提供しているSUSE Linux Enterprise Server(以下SLESと表記)においてBtrfsをデフォルトのファイルシステムにしているためでしょう。ちなみにSLES、およびその元となるOpen SUSEは最もBtrfsを使いこなしているディストリビューションだと筆者は考えています。前述のようにBtrfsをデフォルトファイルシステムにしているだけでなく、システムの様々な運用管理にBtrfsの機能を統合しています。たとえばパッケージのインストール時には、その前後でスナップショットを自動的に採取しており、問題発生時にはシステムをパッケージのインストール前の状態に即座に復旧できるようになっています。SUSEはかつて同社に在籍していたこともあるChrisさんと密接に連携してこれら機能を実現しているそうです。

富士通が開発に参加する動機は、同社のミッションクリティカルシステムにBtrfsを適用するためのようです。Oracleは同社が提供するOracle LinuxにおいてBtrfsをサポートしているためにBtrfsの開発に参加していると考えられます。

上記企業とその関係者(たとえばSLESやOracle Linuxのユーザ)以外にも、NETGEARやSynlogyのNASがBtrfsを利用していたり、各種ディストリビューションがBtrfsをサポートしたりと、Btrfsは広く利用されています。

今後については、たとえば最近GoogleがAndroidにおいてBtrfsの使用を検討しているというニュースが出ました。その関係か、最近はGoogleのエンジニアからパッチが投稿されるようになってきました。

その他には、Red Hat Enterprise Linux(以下RHEL)がBtrfsをサポートしなくなったというニュースがありました。これを受けて「Btrfsはもう先が無い」などといった意見も見られましたが、それは大きな誤解です。第一にBtrfsの開発リソースという観点でいうと、現時点でBtrfsの開発におけるRed Hat社の存在感は小さなものであり、開発の継続にはほとんど影響がありません。かつて同社のエンジニアはBtrfsに定期的にパッチをcommitしていたものの、その頻度は次第に低下してゆきました。2014年のcommitを最後に、ここ数年同社はすでにBtrfsの開発にほぼ参加していない状態でした。第二にユーザ数という観点でも、これによってBtrfsのユーザ数もそれほど減らないと考えられます。なぜならRHELにおけるBtrfsはテスト用に使うのを意図しており、実運用に投入する目的ではないTechnology Preview Featureという扱いだったからです。

上記の通り、Btrfsの開発、利用は現在も活発ですし、これからもより活発になると考えます。
